# clang-format configuration for OpenBSD KNF style
# https://man.openbsd.org/style
#
# Run: clang-format -i src/**/*.c inc/**/*.h
# Or install editor integration for format-on-save

---
Language: Cpp
Standard: c11

# Indentation: 8-space tabs, 4-space continuation
IndentWidth: 8
TabWidth: 8
UseTab: ForIndentation
ContinuationIndentWidth: 4

# Line length
ColumnLimit: 80

# Braces: K&R style (opening brace on same line for control, new line for functions)
BreakBeforeBraces: Custom
BraceWrapping:
  AfterFunction: true
  AfterControlStatement: Never
  AfterEnum: false
  AfterStruct: false
  AfterUnion: false
  BeforeElse: false
  BeforeWhile: false
  SplitEmptyFunction: false
  SplitEmptyRecord: false

# Function return type on its own line
AlwaysBreakAfterReturnType: TopLevel

# Pointer alignment: * with type (not variable)
PointerAlignment: Right
DerivePointerAlignment: false

# Spaces
SpaceAfterCStyleCast: false
SpaceBeforeParens: ControlStatements
SpaceInEmptyParentheses: false
SpacesInParentheses: false
SpacesInSquareBrackets: false
SpaceBeforeSquareBrackets: false

# Don't sort includes (KNF has specific ordering rules)
SortIncludes: Never

# Keep short functions on one line: no
AllowShortFunctionsOnASingleLine: None
AllowShortBlocksOnASingleLine: Never
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false
AllowShortCaseLabelsOnASingleLine: false

# Switch case indentation
IndentCaseLabels: false
IndentCaseBlocks: false

# Comments
ReflowComments: true
SpacesBeforeTrailingComments: 1

# Align
AlignAfterOpenBracket: DontAlign
AlignConsecutiveAssignments: false
AlignConsecutiveDeclarations: false
AlignEscapedNewlines: Right
AlignOperands: true
AlignTrailingComments: true

# Break before binary operators
BreakBeforeBinaryOperators: None

# Pack struct members
BinPackArguments: true
BinPackParameters: true

# Penalty settings to prefer certain breaks
PenaltyBreakAssignment: 2
PenaltyBreakBeforeFirstCallParameter: 19
PenaltyBreakComment: 300
PenaltyBreakFirstLessLess: 120
PenaltyBreakString: 1000
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 0

# Don't put all args on new line if they don't fit
AllowAllArgumentsOnNextLine: true
AllowAllParametersOfDeclarationOnNextLine: true

# Maximum empty lines
MaxEmptyLinesToKeep: 1
KeepEmptyLinesAtTheStartOfBlocks: false

# Include categories (for future SortIncludes if enabled)
# System headers first, then local
IncludeBlocks: Preserve
...
